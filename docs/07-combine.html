<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Combining</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R4SSP Semester 1 2023</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Modules
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Intro</li>
    <li>
      <a href="01-intro.html">Intro to R and RStudio</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Data Focus</li>
    <li>
      <a href="02-visualise.html">Part 1: Visualising</a>
    </li>
    <li>
      <a href="03-subset.html">Part 2: Subsetting</a>
    </li>
    <li>
      <a href="04-communicate.html">Part 3: Communicating</a>
    </li>
    <li>
      <a href="05-summarise.html">Part 4: Summarising</a>
    </li>
    <li>
      <a href="06-tidying.html">Part 5: Tidying</a>
    </li>
    <li>
      <a href="07-combine.html">Part 6: Combining</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Programming focus</li>
    <li>
      <a href="08-functions.html">Functions and Choices</a>
    </li>
    <li>
      <a href="09-iterate.html">Repeating Code</a>
    </li>
    <li>
      <a href="10-workflows.html">Workflows</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Extra</li>
    <li class="dropdown-header">Version control</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Zoom Notes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="zoom_notes_01_intro.html">01 - Introducing R and RStudio</a>
    </li>
    <li>
      <a href="zoom_notes_02_visualise.html">02 - Visualising data</a>
    </li>
    <li>
      <a href="zoom_notes_03_subset.html">03 - Subsetting data</a>
    </li>
    <li>
      <a href="zoom_notes_04_communicate.html">04- Communicating data</a>
    </li>
    <li>
      <a href="zoom_notes_05_summarise.html">05 - Summarising data</a>
    </li>
    <li>
      <a href="zoom_notes_06_tidying.html">06 - Tidying data</a>
    </li>
    <li>
      <a href="zoom_notes_07_combine.html">07 - Combining data</a>
    </li>
    <li>
      <a href="zoom_notes_08_functions.html">08 - Functions and Choices</a>
    </li>
    <li>
      <a href="zoom_notes_09_iterate.html">09 - Repeating Code</a>
    </li>
    <li>
      <a href="zoom_notes_10_workflows.html">10 - Workflows</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Combining</h1>
<h4 class="date">Semester 1, 2023</h4>

</div>


<blockquote>
<h4 id="associated-material">Associated Material</h4>
<p>Module: <a href="07-combine.html">Module 07 - Combining data</a></p>
<p>Readings</p>
<ul>
<li><a href="https://r4ds.had.co.nz/relational-data.html">R for Data
Science Chapter 13</a></li>
</ul>
</blockquote>
<div id="combining-data" class="section level2">
<h2>Combining Data</h2>
<p>Often we’ll find ourselves in the situation where we have some data
but we want to increase its usefulness by adding on additional data.
This module will cover the various ways we can take two dataframes and
combine them together into a single dataframe. The first approach we’ll
look at is the situation where you want to either add more rows or more
columns to an existing dataset. The second situation we’ll look at is
where there is a defined relationship between multiple datasets and we
want to join them together.</p>
<div id="binds" class="section level3">
<h3>Binds</h3>
<p>Sometimes we have datasets that contain the same columns, or the same
rows but might are in two separate files or variables because they were
collected that way or some other reason, and we want to bring them back
together.</p>
<div id="row-binds" class="section level4">
<h4>Row binds</h4>
<p>In the situation where we have new observations (rows) but the same
variables (columns) that we want to add onto our existing dataframe, we
call this row binding.</p>
<pre class="r"><code>dogs_dunedin &lt;- data.frame(names = c(&quot;zippo&quot;, &quot;sky&quot;, &quot;nova&quot;), dog_breed = c(&quot;poodle&quot;, &quot;labrador&quot;, &quot;bulldog&quot;))
dogs_dunedin
#&gt;   names dog_breed
#&gt; 1 zippo    poodle
#&gt; 2   sky  labrador
#&gt; 3  nova   bulldog

dogs_christchurch &lt;- data.frame(names = c(&quot;flash&quot;, &quot;dog&quot;, &quot;jess&quot;), dog_breed = c(&quot;terrier&quot;, &quot;collie&quot;, &quot;collie&quot;))
dogs_christchurch
#&gt;   names dog_breed
#&gt; 1 flash   terrier
#&gt; 2   dog    collie
#&gt; 3  jess    collie</code></pre>
<pre class="r"><code>dogs &lt;- rbind(dogs_dunedin, dogs_christchurch)
dogs
#&gt;   names dog_breed
#&gt; 1 zippo    poodle
#&gt; 2   sky  labrador
#&gt; 3  nova   bulldog
#&gt; 4 flash   terrier
#&gt; 5   dog    collie
#&gt; 6  jess    collie</code></pre>
<p>Note that if your column names don’t match between your dataframes
you will get an error when you try to do your row bind.</p>
<p><br />
</p>
</div>
<div id="column-binding" class="section level4">
<h4>Column binding</h4>
<p><strong>Caution needs to be applied when using column
binding.</strong> Column binding relies entirely upon the rows being in
the correct order and there is no enforcement of relationships that may
have been present and it’s entirely possible for the row order to have
been changed in one or both dataframes prior to the bind.</p>
<pre class="r"><code>pet_weights &lt;- data.frame(animal = c(&quot;dog&quot;, &quot;cat&quot;, &quot;turtle&quot;), weight_kg = c(21, 3, 14) )
pet_weights
#&gt;   animal weight_kg
#&gt; 1    dog        21
#&gt; 2    cat         3
#&gt; 3 turtle        14


pet_names &lt;- data.frame(name = c(&quot;tbone&quot;, &quot;slink&quot;, &quot;speedy&quot;), animal_type = c(&quot;dog&quot;, &quot;cat&quot;, &quot;turtle&quot;))
pet_names
#&gt;     name animal_type
#&gt; 1  tbone         dog
#&gt; 2  slink         cat
#&gt; 3 speedy      turtle


pets &lt;- cbind(pet_weights, pet_names)
pets
#&gt;   animal weight_kg   name animal_type
#&gt; 1    dog        21  tbone         dog
#&gt; 2    cat         3  slink         cat
#&gt; 3 turtle        14 speedy      turtle</code></pre>
<p>Here is the same data, except one has had the rows reordered prior to
the bind to demonstrate</p>
<pre class="r"><code>pet_weights_ordered &lt;- pet_weights %&gt;% arrange(weight_kg)
pet_weights_ordered
#&gt;   animal weight_kg
#&gt; 1    cat         3
#&gt; 2 turtle        14
#&gt; 3    dog        21

pets2 &lt;- cbind(pet_weights_ordered, pet_names)
pets2
#&gt;   animal weight_kg   name animal_type
#&gt; 1    cat         3  tbone         dog
#&gt; 2 turtle        14  slink         cat
#&gt; 3    dog        21 speedy      turtle</code></pre>
<p>It’s also entirey possible to end up with duplicate column names,
making future subsetting more challenging.</p>
<pre class="r"><code>pet_weights &lt;- data.frame(animal = c(&quot;dog&quot;, &quot;cat&quot;, &quot;turtle&quot;), weight_kg = c(21, 3, 14) )
pet_weights
#&gt;   animal weight_kg
#&gt; 1    dog        21
#&gt; 2    cat         3
#&gt; 3 turtle        14


pet_names &lt;- data.frame(name = c(&quot;tbone&quot;, &quot;slink&quot;, &quot;speedy&quot;), animal = c(&quot;collie&quot;, &quot;short hair&quot;, &quot;snapping&quot;))
pet_names
#&gt;     name     animal
#&gt; 1  tbone     collie
#&gt; 2  slink short hair
#&gt; 3 speedy   snapping


pets3 &lt;- cbind(pet_weights, pet_names)
pets3
#&gt;   animal weight_kg   name     animal
#&gt; 1    dog        21  tbone     collie
#&gt; 2    cat         3  slink short hair
#&gt; 3 turtle        14 speedy   snapping

# pulls out first instance of column name
pets3$animal
#&gt; [1] &quot;dog&quot;    &quot;cat&quot;    &quot;turtle&quot;</code></pre>
<p>It’s for this reason that when we’re wanting to add columns that we
are better off doing so in way where we can specify the relationship
between the datasets. This is where <strong>joins</strong> come in.
 </p>
</div>
</div>
<div id="joins" class="section level3">
<h3>Joins</h3>
<p>Joins are used when we have relationships between our data and might
have been stored in a relational database. The functions we’ll be using
come out of the <code>dplyr</code> package which is loaded and part of
<code>tidyverse</code> and mirror their namesakes from a language
commonly used with databases - SQL (Structured Query Language).</p>
<p>As part of the <code>nycflights13</code> package we also have some
other dataframes available, <code>airports</code>, <code>planes</code>,
and <code>airlines</code>. We can use these datasets to add on extra
information to our tables:</p>
<pre class="r"><code># install.packages(&quot;nycflights13&quot;)
library(nycflights13)
library(tidyverse)

glimpse(airports)
#&gt; Rows: 1,458
#&gt; Columns: 8
#&gt; $ faa   &lt;chr&gt; &quot;04G&quot;, &quot;06A&quot;, &quot;06C&quot;, &quot;06N&quot;, &quot;09J&quot;, &quot;0A9&quot;, &quot;0G6&quot;, &quot;0G7&quot;, &quot;0P2&quot;, &quot;…
#&gt; $ name  &lt;chr&gt; &quot;Lansdowne Airport&quot;, &quot;Moton Field Municipal Airport&quot;, &quot;Schaumbur…
#&gt; $ lat   &lt;dbl&gt; 41.13047, 32.46057, 41.98934, 41.43191, 31.07447, 36.37122, 41.4…
#&gt; $ lon   &lt;dbl&gt; -80.61958, -85.68003, -88.10124, -74.39156, -81.42778, -82.17342…
#&gt; $ alt   &lt;dbl&gt; 1044, 264, 801, 523, 11, 1593, 730, 492, 1000, 108, 409, 875, 10…
#&gt; $ tz    &lt;dbl&gt; -5, -6, -6, -5, -5, -5, -5, -5, -5, -8, -5, -6, -5, -5, -5, -5, …
#&gt; $ dst   &lt;chr&gt; &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;U&quot;, &quot;A&quot;, &quot;A&quot;, &quot;U&quot;, &quot;A&quot;,…
#&gt; $ tzone &lt;chr&gt; &quot;America/New_York&quot;, &quot;America/Chicago&quot;, &quot;America/Chicago&quot;, &quot;Ameri…

glimpse(planes)
#&gt; Rows: 3,322
#&gt; Columns: 9
#&gt; $ tailnum      &lt;chr&gt; &quot;N10156&quot;, &quot;N102UW&quot;, &quot;N103US&quot;, &quot;N104UW&quot;, &quot;N10575&quot;, &quot;N105UW…
#&gt; $ year         &lt;int&gt; 2004, 1998, 1999, 1999, 2002, 1999, 1999, 1999, 1999, 199…
#&gt; $ type         &lt;chr&gt; &quot;Fixed wing multi engine&quot;, &quot;Fixed wing multi engine&quot;, &quot;Fi…
#&gt; $ manufacturer &lt;chr&gt; &quot;EMBRAER&quot;, &quot;AIRBUS INDUSTRIE&quot;, &quot;AIRBUS INDUSTRIE&quot;, &quot;AIRBU…
#&gt; $ model        &lt;chr&gt; &quot;EMB-145XR&quot;, &quot;A320-214&quot;, &quot;A320-214&quot;, &quot;A320-214&quot;, &quot;EMB-145…
#&gt; $ engines      &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …
#&gt; $ seats        &lt;int&gt; 55, 182, 182, 182, 55, 182, 182, 182, 182, 182, 55, 55, 5…
#&gt; $ speed        &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
#&gt; $ engine       &lt;chr&gt; &quot;Turbo-fan&quot;, &quot;Turbo-fan&quot;, &quot;Turbo-fan&quot;, &quot;Turbo-fan&quot;, &quot;Turb…

glimpse(airlines)
#&gt; Rows: 16
#&gt; Columns: 2
#&gt; $ carrier &lt;chr&gt; &quot;9E&quot;, &quot;AA&quot;, &quot;AS&quot;, &quot;B6&quot;, &quot;DL&quot;, &quot;EV&quot;, &quot;F9&quot;, &quot;FL&quot;, &quot;HA&quot;, &quot;MQ&quot;, &quot;O…
#&gt; $ name    &lt;chr&gt; &quot;Endeavor Air Inc.&quot;, &quot;American Airlines Inc.&quot;, &quot;Alaska Airline…

glimpse(weather)
#&gt; Rows: 26,115
#&gt; Columns: 15
#&gt; $ origin     &lt;chr&gt; &quot;EWR&quot;, &quot;EWR&quot;, &quot;EWR&quot;, &quot;EWR&quot;, &quot;EWR&quot;, &quot;EWR&quot;, &quot;EWR&quot;, &quot;EWR&quot;, &quot;EW…
#&gt; $ year       &lt;int&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013,…
#&gt; $ month      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
#&gt; $ day        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
#&gt; $ hour       &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, …
#&gt; $ temp       &lt;dbl&gt; 39.02, 39.02, 39.02, 39.92, 39.02, 37.94, 39.02, 39.92, 39.…
#&gt; $ dewp       &lt;dbl&gt; 26.06, 26.96, 28.04, 28.04, 28.04, 28.04, 28.04, 28.04, 28.…
#&gt; $ humid      &lt;dbl&gt; 59.37, 61.63, 64.43, 62.21, 64.43, 67.21, 64.43, 62.21, 62.…
#&gt; $ wind_dir   &lt;dbl&gt; 270, 250, 240, 250, 260, 240, 240, 250, 260, 260, 260, 330,…
#&gt; $ wind_speed &lt;dbl&gt; 10.35702, 8.05546, 11.50780, 12.65858, 12.65858, 11.50780, …
#&gt; $ wind_gust  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 20.…
#&gt; $ precip     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
#&gt; $ pressure   &lt;dbl&gt; 1012.0, 1012.3, 1012.5, 1012.2, 1011.9, 1012.4, 1012.2, 101…
#&gt; $ visib      &lt;dbl&gt; 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,…
#&gt; $ time_hour  &lt;dttm&gt; 2013-01-01 01:00:00, 2013-01-01 02:00:00, 2013-01-01 03:00…</code></pre>
<p>Here is a diagram from <a
href="https://r4ds.had.co.nz/relational-data.html">R for Data Science -
Relational Data</a> chapter showing the relationships between the
<code>nycflights13</code> dataframes.</p>
<div class="figure">
<img
src="https://d33wubrfki0l68.cloudfront.net/245292d1ea724f6c3fd8a92063dcd7bfb9758d02/5751b/diagrams/relational-nycflights.png"
alt="" />
<p class="caption">R for Data Science - nycflights13 data
relationships</p>
</div>
<p>Ultimately we want to use the relationships between the data to find
out the name of the airline that flew the total furthest distance using
single engine planes.</p>
<p>But before we tackle that question, we first need to cover how to
combine different data together using <strong>joins</strong> or
<strong>merges</strong>. In order for us to join two dataframes
together, we need to have a way of linking the information between the
two tables, we need an common-identifier or <strong>key</strong> that is
shared between them. Let’s examine how joins work using some examples
first</p>
<pre class="r"><code>df_a &lt;- data.frame(names = c(&quot;A&quot;, &quot;B&quot;,&quot;C&quot;), animals = c(&quot;cat&quot;, &quot;dog&quot;,&quot;mouse&quot;))
df_a
#&gt;   names animals
#&gt; 1     A     cat
#&gt; 2     B     dog
#&gt; 3     C   mouse


df_b &lt;- data.frame(names = c(&quot;A&quot;, &quot;C&quot;, &quot;D&quot;), counts = c(1, 2, 3))
df_b
#&gt;   names counts
#&gt; 1     A      1
#&gt; 2     C      2
#&gt; 3     D      3</code></pre>
<p>For joins, we use an identifier column (key) that has entires in
common between the two dataframes. The values in this column are then
used to match rows between the dataframes and the corresponding columns
are brought together. There are three main types of joins we’ll look
at:</p>
<div id="inner-joins" class="section level4">
<h4>Inner Joins</h4>
<p>Inner joins will only keep rows that have matching values in the
identifier column between the two dataframes. Rows that cannot be
matched are removed.</p>
<pre class="r"><code>inner_join(df_a, df_b, by = &quot;names&quot;)
#&gt;   names animals counts
#&gt; 1     A     cat      1
#&gt; 2     C   mouse      2</code></pre>
</div>
<div id="directional-joins" class="section level4">
<h4>Directional joins</h4>
<p>Directional joins will keep all of the rows with the dataframe
specified by the direction, and add on data that matches from the second
dataframe. The most commonly used is the left join, but right joins are
also used. These joins are usually used when you want to keep all of the
data in your starting dataset but you want to add on more information
where you can.</p>
<pre class="r"><code>left_join(df_a, df_b, by = &quot;names&quot;)
#&gt;   names animals counts
#&gt; 1     A     cat      1
#&gt; 2     B     dog     NA
#&gt; 3     C   mouse      2

right_join(df_a, df_b, by = &quot;names&quot;)
#&gt;   names animals counts
#&gt; 1     A     cat      1
#&gt; 2     C   mouse      2
#&gt; 3     D    &lt;NA&gt;      3</code></pre>
</div>
<div id="full-joins" class="section level4">
<h4>Full Joins</h4>
<p>Full joins will match by the identifying column, where rows cannot be
matched they are filled in with missing data in the columns that are new
for the respective dataframe. This type of joins will keep all data.</p>
<pre class="r"><code>full_join(df_a, df_b, by = &quot;names&quot;)
#&gt;   names animals counts
#&gt; 1     A     cat      1
#&gt; 2     B     dog     NA
#&gt; 3     C   mouse      2
#&gt; 4     D    &lt;NA&gt;      3</code></pre>
</div>
<div id="joining-nycflights" class="section level4">
<h4>Joining nycflights</h4>
<p>Now that we have an idea about how joins work, lets set about
answering our question of which airline flew the total furthest distance
using single engine planes.</p>
<p><br />
</p>
<p>We can now begin to solve our question in pieces:</p>
<p><br />
</p>
<ol style="list-style-type: decimal">
<li>We need to know which planes were single engine</li>
</ol>
<pre class="r"><code>single_engine &lt;- planes %&gt;% filter(engines == 1)</code></pre>
<p><br />
</p>
<ol start="2" style="list-style-type: decimal">
<li>We need to identify which column can be used to link our single
engine data with our flights data.</li>
</ol>
<pre class="r"><code># identify column names in common between single_engine and flights
names(single_engine)[names(single_engine) %in% names(flights)]
#&gt; [1] &quot;tailnum&quot; &quot;year&quot;</code></pre>
<p>Tailnum is going to identify our planes between our two datasets. It
is possible to use multiple keys in joins - however in our case
<code>flights$year</code> refers to the year of the flight, but
<code>single_engine$year</code> refers to the year of the aircraft.</p>
<p><br />
</p>
<ol start="3" style="list-style-type: decimal">
<li>We now need to join with our flights data so that only the flights
involving planes with single engines remain.</li>
</ol>
<pre class="r"><code>single_engine_flights &lt;- inner_join(flights, single_engine, by = &quot;tailnum&quot;)

names(single_engine_flights)
#&gt;  [1] &quot;year.x&quot;         &quot;month&quot;          &quot;day&quot;            &quot;dep_time&quot;      
#&gt;  [5] &quot;sched_dep_time&quot; &quot;dep_delay&quot;      &quot;arr_time&quot;       &quot;sched_arr_time&quot;
#&gt;  [9] &quot;arr_delay&quot;      &quot;carrier&quot;        &quot;flight&quot;         &quot;tailnum&quot;       
#&gt; [13] &quot;origin&quot;         &quot;dest&quot;           &quot;air_time&quot;       &quot;distance&quot;      
#&gt; [17] &quot;hour&quot;           &quot;minute&quot;         &quot;time_hour&quot;      &quot;year.y&quot;        
#&gt; [21] &quot;type&quot;           &quot;manufacturer&quot;   &quot;model&quot;          &quot;engines&quot;       
#&gt; [25] &quot;seats&quot;          &quot;speed&quot;          &quot;engine&quot;</code></pre>
<p>Notice that we have year.x and year.y columns, this is because there
were columns that had the same name in our datasets, but were not
representing the same data. We can make these more informative going
forward by redoing our join and this time supplying a
<code>suffix</code> parameter so we know which dataset the columns
originally were from</p>
<pre class="r"><code>single_engine_flights &lt;- inner_join(flights, single_engine, by = &quot;tailnum&quot;, suffix = c(&quot;_flight&quot;, &quot;_plane&quot;))

names(single_engine_flights)
#&gt;  [1] &quot;year_flight&quot;    &quot;month&quot;          &quot;day&quot;            &quot;dep_time&quot;      
#&gt;  [5] &quot;sched_dep_time&quot; &quot;dep_delay&quot;      &quot;arr_time&quot;       &quot;sched_arr_time&quot;
#&gt;  [9] &quot;arr_delay&quot;      &quot;carrier&quot;        &quot;flight&quot;         &quot;tailnum&quot;       
#&gt; [13] &quot;origin&quot;         &quot;dest&quot;           &quot;air_time&quot;       &quot;distance&quot;      
#&gt; [17] &quot;hour&quot;           &quot;minute&quot;         &quot;time_hour&quot;      &quot;year_plane&quot;    
#&gt; [21] &quot;type&quot;           &quot;manufacturer&quot;   &quot;model&quot;          &quot;engines&quot;       
#&gt; [25] &quot;seats&quot;          &quot;speed&quot;          &quot;engine&quot;</code></pre>
<p><br />
</p>
<ol start="4" style="list-style-type: decimal">
<li>Now we’ll find the total distance for each carrier</li>
</ol>
<pre class="r"><code>total_single_engine_carrier_distance &lt;- single_engine_flights %&gt;% 
  group_by(carrier) %&gt;% 
  summarise(total_distance = sum(distance))</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>And now we need to add on the carrier names and sort the result so
the longest distance is first. This time we’ll do it using pipe.</li>
</ol>
<pre class="r"><code>total_single_engine_carrier_distance %&gt;% 
  inner_join(airlines, by = &#39;carrier&#39;) %&gt;% 
  arrange(desc(total_distance))
#&gt; # A tibble: 4 × 3
#&gt;   carrier total_distance name                       
#&gt;   &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;                      
#&gt; 1 B6             1077735 JetBlue Airways            
#&gt; 2 AA              882584 American Airlines Inc.     
#&gt; 3 MQ              244203 Envoy Air                  
#&gt; 4 FL                2286 AirTran Airways Corporation</code></pre>
<p>From this we can see that JetBlue Airways flew the longest distance
using single-engine planes.</p>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQ29tYmluaW5nIgpkYXRlOiAiU2VtZXN0ZXIgMSwgMjAyMyIKb3V0cHV0OgogIGh0bWxfZG9jdW1lbnQ6CiAgICB0b2M6IHRydWUKICAgIHRvY19mbG9hdDogdHJ1ZQogICAgdG9jX2RlcHRoOiAzCiAgICBjb2RlX2Rvd25sb2FkOiB0cnVlCiAgICBjb2RlX2ZvbGRpbmc6IHNob3cKLS0tCgpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRX0KbGlicmFyeShrbml0cikKbGlicmFyeSh0aWR5dmVyc2UpCmtuaXRyOjpvcHRzX2NodW5rJHNldCgKICBjb21tZW50ID0gIiM+IiwKICBmaWcucGF0aCA9ICJmaWd1cmVzLzA3LyIsICMgdXNlIG9ubHkgZm9yIHNpbmdsZSBSbWQgZmlsZXMKICBjb2xsYXBzZSA9IFRSVUUsCiAgZWNobyA9IFRSVUUKKQpgYGAKCj4gIyMjIyBBc3NvY2lhdGVkIE1hdGVyaWFsCj4KPiBNb2R1bGU6IFtNb2R1bGUgMDcgLSBDb21iaW5pbmcgZGF0YV0oMDctY29tYmluZS5odG1sKQo+Cj4gUmVhZGluZ3MKPgo+IC0gW1IgZm9yIERhdGEgU2NpZW5jZSBDaGFwdGVyIDEzXShodHRwczovL3I0ZHMuaGFkLmNvLm56L3JlbGF0aW9uYWwtZGF0YS5odG1sKQoKCiMjIENvbWJpbmluZyBEYXRhCgpPZnRlbiB3ZSdsbCBmaW5kIG91cnNlbHZlcyBpbiB0aGUgc2l0dWF0aW9uIHdoZXJlIHdlIGhhdmUgc29tZSBkYXRhIGJ1dCB3ZSB3YW50IHRvIGluY3JlYXNlIGl0cyB1c2VmdWxuZXNzIGJ5IGFkZGluZyBvbiBhZGRpdGlvbmFsIGRhdGEuIFRoaXMgbW9kdWxlIHdpbGwgY292ZXIgdGhlIHZhcmlvdXMgd2F5cyB3ZSBjYW4gdGFrZSB0d28gZGF0YWZyYW1lcyBhbmQgY29tYmluZSB0aGVtIHRvZ2V0aGVyIGludG8gYSBzaW5nbGUgZGF0YWZyYW1lLiBUaGUgZmlyc3QgYXBwcm9hY2ggd2UnbGwgbG9vayBhdCBpcyB0aGUgc2l0dWF0aW9uIHdoZXJlIHlvdSB3YW50IHRvIGVpdGhlciBhZGQgbW9yZSByb3dzIG9yIG1vcmUgY29sdW1ucyB0byBhbiBleGlzdGluZyBkYXRhc2V0LiBUaGUgc2Vjb25kIHNpdHVhdGlvbiB3ZSdsbCBsb29rIGF0IGlzIHdoZXJlIHRoZXJlIGlzIGEgZGVmaW5lZCByZWxhdGlvbnNoaXAgYmV0d2VlbiBtdWx0aXBsZSBkYXRhc2V0cyBhbmQgd2Ugd2FudCB0byBqb2luIHRoZW0gdG9nZXRoZXIuCgojIyMgQmluZHMKClNvbWV0aW1lcyB3ZSBoYXZlIGRhdGFzZXRzIHRoYXQgY29udGFpbiB0aGUgc2FtZSBjb2x1bW5zLCBvciB0aGUgc2FtZSByb3dzIGJ1dCBtaWdodCBhcmUgaW4gdHdvIHNlcGFyYXRlIGZpbGVzIG9yIHZhcmlhYmxlcyBiZWNhdXNlIHRoZXkgd2VyZSBjb2xsZWN0ZWQgdGhhdCB3YXkgb3Igc29tZSBvdGhlciByZWFzb24sIGFuZCB3ZSB3YW50IHRvIGJyaW5nIHRoZW0gYmFjayB0b2dldGhlci4KCiMjIyMgUm93IGJpbmRzCgpJbiB0aGUgc2l0dWF0aW9uIHdoZXJlIHdlIGhhdmUgbmV3IG9ic2VydmF0aW9ucyAocm93cykgYnV0IHRoZSBzYW1lIHZhcmlhYmxlcyAoY29sdW1ucykgdGhhdCB3ZSB3YW50IHRvIGFkZCBvbnRvIG91ciBleGlzdGluZyBkYXRhZnJhbWUsIHdlIGNhbGwgdGhpcyByb3cgYmluZGluZy4KCmBgYHtyfQpkb2dzX2R1bmVkaW4gPC0gZGF0YS5mcmFtZShuYW1lcyA9IGMoInppcHBvIiwgInNreSIsICJub3ZhIiksIGRvZ19icmVlZCA9IGMoInBvb2RsZSIsICJsYWJyYWRvciIsICJidWxsZG9nIikpCmRvZ3NfZHVuZWRpbgoKZG9nc19jaHJpc3RjaHVyY2ggPC0gZGF0YS5mcmFtZShuYW1lcyA9IGMoImZsYXNoIiwgImRvZyIsICJqZXNzIiksIGRvZ19icmVlZCA9IGMoInRlcnJpZXIiLCAiY29sbGllIiwgImNvbGxpZSIpKQpkb2dzX2NocmlzdGNodXJjaApgYGAKCgpgYGB7cn0KZG9ncyA8LSByYmluZChkb2dzX2R1bmVkaW4sIGRvZ3NfY2hyaXN0Y2h1cmNoKQpkb2dzCmBgYAoKTm90ZSB0aGF0IGlmIHlvdXIgY29sdW1uIG5hbWVzIGRvbid0IG1hdGNoIGJldHdlZW4geW91ciBkYXRhZnJhbWVzIHlvdSB3aWxsIGdldCBhbiBlcnJvciB3aGVuIHlvdSB0cnkgdG8gZG8geW91ciByb3cgYmluZC4KClwKCiMjIyMgQ29sdW1uIGJpbmRpbmcKCioqQ2F1dGlvbiBuZWVkcyB0byBiZSBhcHBsaWVkIHdoZW4gdXNpbmcgY29sdW1uIGJpbmRpbmcuKiogQ29sdW1uIGJpbmRpbmcgcmVsaWVzIGVudGlyZWx5IHVwb24gdGhlIHJvd3MgYmVpbmcgaW4gdGhlIGNvcnJlY3Qgb3JkZXIgYW5kIHRoZXJlIGlzIG5vIGVuZm9yY2VtZW50IG9mIHJlbGF0aW9uc2hpcHMgdGhhdCBtYXkgaGF2ZSBiZWVuIHByZXNlbnQgYW5kIGl0J3MgZW50aXJlbHkgcG9zc2libGUgZm9yIHRoZSByb3cgb3JkZXIgdG8gaGF2ZSBiZWVuIGNoYW5nZWQgaW4gb25lIG9yIGJvdGggZGF0YWZyYW1lcyBwcmlvciB0byB0aGUgYmluZC4gCgoKYGBge3J9CnBldF93ZWlnaHRzIDwtIGRhdGEuZnJhbWUoYW5pbWFsID0gYygiZG9nIiwgImNhdCIsICJ0dXJ0bGUiKSwgd2VpZ2h0X2tnID0gYygyMSwgMywgMTQpICkKcGV0X3dlaWdodHMKCgpwZXRfbmFtZXMgPC0gZGF0YS5mcmFtZShuYW1lID0gYygidGJvbmUiLCAic2xpbmsiLCAic3BlZWR5IiksIGFuaW1hbF90eXBlID0gYygiZG9nIiwgImNhdCIsICJ0dXJ0bGUiKSkKcGV0X25hbWVzCgoKcGV0cyA8LSBjYmluZChwZXRfd2VpZ2h0cywgcGV0X25hbWVzKQpwZXRzCmBgYApIZXJlIGlzIHRoZSBzYW1lIGRhdGEsIGV4Y2VwdCBvbmUgaGFzIGhhZCB0aGUgcm93cyByZW9yZGVyZWQgcHJpb3IgdG8gdGhlIGJpbmQgdG8gZGVtb25zdHJhdGUgCgpgYGB7cn0KcGV0X3dlaWdodHNfb3JkZXJlZCA8LSBwZXRfd2VpZ2h0cyAlPiUgYXJyYW5nZSh3ZWlnaHRfa2cpCnBldF93ZWlnaHRzX29yZGVyZWQKCnBldHMyIDwtIGNiaW5kKHBldF93ZWlnaHRzX29yZGVyZWQsIHBldF9uYW1lcykKcGV0czIKYGBgCgpJdCdzIGFsc28gZW50aXJleSBwb3NzaWJsZSB0byBlbmQgdXAgd2l0aCBkdXBsaWNhdGUgY29sdW1uIG5hbWVzLCBtYWtpbmcgZnV0dXJlIHN1YnNldHRpbmcgbW9yZSBjaGFsbGVuZ2luZy4KCmBgYHtyfQpwZXRfd2VpZ2h0cyA8LSBkYXRhLmZyYW1lKGFuaW1hbCA9IGMoImRvZyIsICJjYXQiLCAidHVydGxlIiksIHdlaWdodF9rZyA9IGMoMjEsIDMsIDE0KSApCnBldF93ZWlnaHRzCgoKcGV0X25hbWVzIDwtIGRhdGEuZnJhbWUobmFtZSA9IGMoInRib25lIiwgInNsaW5rIiwgInNwZWVkeSIpLCBhbmltYWwgPSBjKCJjb2xsaWUiLCAic2hvcnQgaGFpciIsICJzbmFwcGluZyIpKQpwZXRfbmFtZXMKCgpwZXRzMyA8LSBjYmluZChwZXRfd2VpZ2h0cywgcGV0X25hbWVzKQpwZXRzMwoKIyBwdWxscyBvdXQgZmlyc3QgaW5zdGFuY2Ugb2YgY29sdW1uIG5hbWUKcGV0czMkYW5pbWFsCmBgYApJdCdzIGZvciB0aGlzIHJlYXNvbiB0aGF0IHdoZW4gd2UncmUgd2FudGluZyB0byBhZGQgY29sdW1ucyB0aGF0IHdlIGFyZSBiZXR0ZXIgb2ZmIGRvaW5nIHNvIGluIHdheSB3aGVyZSB3ZSBjYW4gc3BlY2lmeSB0aGUgcmVsYXRpb25zaGlwIGJldHdlZW4gdGhlIGRhdGFzZXRzLiBUaGlzIGlzIHdoZXJlICoqam9pbnMqKiBjb21lIGluLgpcICAKICAKIyMjIEpvaW5zCgpKb2lucyBhcmUgdXNlZCB3aGVuIHdlIGhhdmUgcmVsYXRpb25zaGlwcyBiZXR3ZWVuIG91ciBkYXRhIGFuZCBtaWdodCBoYXZlIGJlZW4gc3RvcmVkIGluIGEgcmVsYXRpb25hbCBkYXRhYmFzZS4gVGhlIGZ1bmN0aW9ucyB3ZSdsbCBiZSB1c2luZyBjb21lIG91dCBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHdoaWNoIGlzIGxvYWRlZCBhbmQgcGFydCBvZiBgdGlkeXZlcnNlYCBhbmQgbWlycm9yIHRoZWlyIG5hbWVzYWtlcyBmcm9tIGEgbGFuZ3VhZ2UgY29tbW9ubHkgdXNlZCB3aXRoIGRhdGFiYXNlcyAtIFNRTCAoU3RydWN0dXJlZCBRdWVyeSBMYW5ndWFnZSkuCgpBcyBwYXJ0IG9mIHRoZSBgbnljZmxpZ2h0czEzYCBwYWNrYWdlIHdlIGFsc28gaGF2ZSBzb21lIG90aGVyIGRhdGFmcmFtZXMgYXZhaWxhYmxlLCBgYWlycG9ydHNgLCBgcGxhbmVzYCwgYW5kIGBhaXJsaW5lc2AuIFdlIGNhbiB1c2UgdGhlc2UgZGF0YXNldHMgdG8gYWRkIG9uIGV4dHJhIGluZm9ybWF0aW9uIHRvIG91ciB0YWJsZXM6IAoKYGBge3J9CiMgaW5zdGFsbC5wYWNrYWdlcygibnljZmxpZ2h0czEzIikKbGlicmFyeShueWNmbGlnaHRzMTMpCmxpYnJhcnkodGlkeXZlcnNlKQoKZ2xpbXBzZShhaXJwb3J0cykKCmdsaW1wc2UocGxhbmVzKQoKZ2xpbXBzZShhaXJsaW5lcykKCmdsaW1wc2Uod2VhdGhlcikKYGBgCgpIZXJlIGlzIGEgZGlhZ3JhbSBmcm9tIFtSIGZvciBEYXRhIFNjaWVuY2UgLSBSZWxhdGlvbmFsIERhdGFdKGh0dHBzOi8vcjRkcy5oYWQuY28ubnovcmVsYXRpb25hbC1kYXRhLmh0bWwpIGNoYXB0ZXIgc2hvd2luZyB0aGUgcmVsYXRpb25zaGlwcyBiZXR3ZWVuIHRoZSBgbnljZmxpZ2h0czEzYCBkYXRhZnJhbWVzLgoKIVtSIGZvciBEYXRhIFNjaWVuY2UgLSBueWNmbGlnaHRzMTMgZGF0YSByZWxhdGlvbnNoaXBzXShodHRwczovL2QzM3d1YnJma2kwbDY4LmNsb3VkZnJvbnQubmV0LzI0NTI5MmQxZWE3MjRmNmMzZmQ4YTkyMDYzZGNkN2JmYjk3NThkMDIvNTc1MWIvZGlhZ3JhbXMvcmVsYXRpb25hbC1ueWNmbGlnaHRzLnBuZykKClVsdGltYXRlbHkgd2Ugd2FudCB0byB1c2UgdGhlIHJlbGF0aW9uc2hpcHMgYmV0d2VlbiB0aGUgZGF0YSB0byBmaW5kIG91dCB0aGUgbmFtZSBvZiB0aGUgYWlybGluZSB0aGF0IGZsZXcgdGhlIHRvdGFsIGZ1cnRoZXN0IGRpc3RhbmNlIHVzaW5nIHNpbmdsZSBlbmdpbmUgcGxhbmVzLgoKQnV0IGJlZm9yZSB3ZSB0YWNrbGUgdGhhdCBxdWVzdGlvbiwgd2UgZmlyc3QgbmVlZCB0byBjb3ZlciBob3cgdG8gY29tYmluZSBkaWZmZXJlbnQgZGF0YSB0b2dldGhlciB1c2luZyAqKmpvaW5zKiogb3IgKiptZXJnZXMqKi4gSW4gb3JkZXIgZm9yIHVzIHRvIGpvaW4gdHdvIGRhdGFmcmFtZXMgdG9nZXRoZXIsIHdlIG5lZWQgdG8gaGF2ZSBhIHdheSBvZiBsaW5raW5nIHRoZSBpbmZvcm1hdGlvbiBiZXR3ZWVuIHRoZSB0d28gdGFibGVzLCB3ZSBuZWVkIGFuIGNvbW1vbi1pZGVudGlmaWVyIG9yICoqa2V5KiogdGhhdCBpcyBzaGFyZWQgYmV0d2VlbiB0aGVtLiBMZXQncyBleGFtaW5lIGhvdyBqb2lucyB3b3JrIHVzaW5nIHNvbWUgZXhhbXBsZXMgZmlyc3QKCmBgYHtyfQpkZl9hIDwtIGRhdGEuZnJhbWUobmFtZXMgPSBjKCJBIiwgIkIiLCJDIiksIGFuaW1hbHMgPSBjKCJjYXQiLCAiZG9nIiwibW91c2UiKSkKZGZfYQoKCmRmX2IgPC0gZGF0YS5mcmFtZShuYW1lcyA9IGMoIkEiLCAiQyIsICJEIiksIGNvdW50cyA9IGMoMSwgMiwgMykpCmRmX2IKYGBgCkZvciBqb2lucywgd2UgdXNlIGFuIGlkZW50aWZpZXIgY29sdW1uIChrZXkpIHRoYXQgaGFzIGVudGlyZXMgaW4gY29tbW9uIGJldHdlZW4gdGhlIHR3byBkYXRhZnJhbWVzLiBUaGUgdmFsdWVzIGluIHRoaXMgY29sdW1uIGFyZSB0aGVuIHVzZWQgdG8gbWF0Y2ggcm93cyBiZXR3ZWVuIHRoZSBkYXRhZnJhbWVzIGFuZCB0aGUgY29ycmVzcG9uZGluZyBjb2x1bW5zIGFyZSBicm91Z2h0IHRvZ2V0aGVyLiBUaGVyZSBhcmUgdGhyZWUgbWFpbiB0eXBlcyBvZiBqb2lucyB3ZSdsbCBsb29rIGF0OgoKCgojIyMjIElubmVyIEpvaW5zCgpJbm5lciBqb2lucyB3aWxsIG9ubHkga2VlcCByb3dzIHRoYXQgaGF2ZSBtYXRjaGluZyB2YWx1ZXMgaW4gdGhlIGlkZW50aWZpZXIgY29sdW1uIGJldHdlZW4gdGhlIHR3byBkYXRhZnJhbWVzLiBSb3dzIHRoYXQgY2Fubm90IGJlIG1hdGNoZWQgYXJlIHJlbW92ZWQuCgpgYGB7cn0KaW5uZXJfam9pbihkZl9hLCBkZl9iLCBieSA9ICJuYW1lcyIpCmBgYAojIyMjIERpcmVjdGlvbmFsIGpvaW5zCgpEaXJlY3Rpb25hbCBqb2lucyB3aWxsIGtlZXAgYWxsIG9mIHRoZSByb3dzIHdpdGggdGhlIGRhdGFmcmFtZSBzcGVjaWZpZWQgYnkgdGhlIGRpcmVjdGlvbiwgYW5kIGFkZCBvbiBkYXRhIHRoYXQgbWF0Y2hlcyBmcm9tIHRoZSBzZWNvbmQgZGF0YWZyYW1lLiBUaGUgbW9zdCBjb21tb25seSB1c2VkIGlzIHRoZSBsZWZ0IGpvaW4sIGJ1dCByaWdodCBqb2lucyBhcmUgYWxzbyB1c2VkLiBUaGVzZSBqb2lucyBhcmUgdXN1YWxseSB1c2VkIHdoZW4geW91IHdhbnQgdG8ga2VlcCBhbGwgb2YgdGhlIGRhdGEgaW4geW91ciBzdGFydGluZyBkYXRhc2V0IGJ1dCB5b3Ugd2FudCB0byBhZGQgb24gbW9yZSBpbmZvcm1hdGlvbiB3aGVyZSB5b3UgY2FuLgoKYGBge3J9CmxlZnRfam9pbihkZl9hLCBkZl9iLCBieSA9ICJuYW1lcyIpCgpyaWdodF9qb2luKGRmX2EsIGRmX2IsIGJ5ID0gIm5hbWVzIikKYGBgCgoKIyMjIyBGdWxsIEpvaW5zCgpGdWxsIGpvaW5zIHdpbGwgbWF0Y2ggYnkgdGhlIGlkZW50aWZ5aW5nIGNvbHVtbiwgd2hlcmUgcm93cyBjYW5ub3QgYmUgbWF0Y2hlZCB0aGV5IGFyZSBmaWxsZWQgaW4gd2l0aCBtaXNzaW5nIGRhdGEgaW4gdGhlIGNvbHVtbnMgdGhhdCBhcmUgbmV3IGZvciB0aGUgcmVzcGVjdGl2ZSBkYXRhZnJhbWUuIFRoaXMgdHlwZSBvZiBqb2lucyB3aWxsIGtlZXAgYWxsIGRhdGEuCgpgYGB7cn0KZnVsbF9qb2luKGRmX2EsIGRmX2IsIGJ5ID0gIm5hbWVzIikKYGBgCgojIyMjIEpvaW5pbmcgbnljZmxpZ2h0cwoKTm93IHRoYXQgd2UgaGF2ZSBhbiBpZGVhIGFib3V0IGhvdyBqb2lucyB3b3JrLCBsZXRzIHNldCBhYm91dCBhbnN3ZXJpbmcgb3VyIHF1ZXN0aW9uIG9mIHdoaWNoIGFpcmxpbmUgZmxldyB0aGUgdG90YWwgZnVydGhlc3QgZGlzdGFuY2UgdXNpbmcgc2luZ2xlIGVuZ2luZSBwbGFuZXMuCgpcCgpXZSBjYW4gbm93IGJlZ2luIHRvIHNvbHZlIG91ciBxdWVzdGlvbiBpbiBwaWVjZXM6CgpcCgoxLiBXZSBuZWVkIHRvIGtub3cgd2hpY2ggcGxhbmVzIHdlcmUgc2luZ2xlIGVuZ2luZQpgYGB7cn0Kc2luZ2xlX2VuZ2luZSA8LSBwbGFuZXMgJT4lIGZpbHRlcihlbmdpbmVzID09IDEpCmBgYAoKXAoKMi4gIFdlIG5lZWQgdG8gaWRlbnRpZnkgd2hpY2ggY29sdW1uIGNhbiBiZSB1c2VkIHRvIGxpbmsgb3VyIHNpbmdsZSBlbmdpbmUgZGF0YSB3aXRoIG91ciBmbGlnaHRzIGRhdGEuCgpgYGB7cn0KIyBpZGVudGlmeSBjb2x1bW4gbmFtZXMgaW4gY29tbW9uIGJldHdlZW4gc2luZ2xlX2VuZ2luZSBhbmQgZmxpZ2h0cwpuYW1lcyhzaW5nbGVfZW5naW5lKVtuYW1lcyhzaW5nbGVfZW5naW5lKSAlaW4lIG5hbWVzKGZsaWdodHMpXQpgYGAKClRhaWxudW0gaXMgZ29pbmcgdG8gaWRlbnRpZnkgb3VyIHBsYW5lcyBiZXR3ZWVuIG91ciB0d28gZGF0YXNldHMuIEl0IGlzIHBvc3NpYmxlIHRvIHVzZSBtdWx0aXBsZSBrZXlzIGluIGpvaW5zIC0gaG93ZXZlciBpbiBvdXIgY2FzZSBgZmxpZ2h0cyR5ZWFyYCByZWZlcnMgdG8gdGhlIHllYXIgb2YgdGhlIGZsaWdodCwgYnV0IGBzaW5nbGVfZW5naW5lJHllYXJgIHJlZmVycyB0byB0aGUgeWVhciBvZiB0aGUgYWlyY3JhZnQuIAoKXAoKMy4gV2Ugbm93IG5lZWQgdG8gam9pbiB3aXRoIG91ciBmbGlnaHRzIGRhdGEgc28gdGhhdCBvbmx5IHRoZSBmbGlnaHRzIGludm9sdmluZyBwbGFuZXMgd2l0aCBzaW5nbGUgZW5naW5lcyByZW1haW4uCgpgYGB7cn0Kc2luZ2xlX2VuZ2luZV9mbGlnaHRzIDwtIGlubmVyX2pvaW4oZmxpZ2h0cywgc2luZ2xlX2VuZ2luZSwgYnkgPSAidGFpbG51bSIpCgpuYW1lcyhzaW5nbGVfZW5naW5lX2ZsaWdodHMpCmBgYAoKTm90aWNlIHRoYXQgd2UgaGF2ZSB5ZWFyLnggYW5kIHllYXIueSBjb2x1bW5zLCB0aGlzIGlzIGJlY2F1c2UgdGhlcmUgd2VyZSBjb2x1bW5zIHRoYXQgaGFkIHRoZSBzYW1lIG5hbWUgaW4gb3VyIGRhdGFzZXRzLCBidXQgd2VyZSBub3QgcmVwcmVzZW50aW5nIHRoZSBzYW1lIGRhdGEuIFdlIGNhbiBtYWtlIHRoZXNlIG1vcmUgaW5mb3JtYXRpdmUgZ29pbmcgZm9yd2FyZCBieSByZWRvaW5nIG91ciBqb2luIGFuZCB0aGlzIHRpbWUgc3VwcGx5aW5nIGEgYHN1ZmZpeGAgcGFyYW1ldGVyIHNvIHdlIGtub3cgd2hpY2ggZGF0YXNldCB0aGUgY29sdW1ucyBvcmlnaW5hbGx5IHdlcmUgZnJvbQoKCmBgYHtyfQpzaW5nbGVfZW5naW5lX2ZsaWdodHMgPC0gaW5uZXJfam9pbihmbGlnaHRzLCBzaW5nbGVfZW5naW5lLCBieSA9ICJ0YWlsbnVtIiwgc3VmZml4ID0gYygiX2ZsaWdodCIsICJfcGxhbmUiKSkKCm5hbWVzKHNpbmdsZV9lbmdpbmVfZmxpZ2h0cykKYGBgCgpcCgo0LiBOb3cgd2UnbGwgZmluZCB0aGUgdG90YWwgZGlzdGFuY2UgZm9yIGVhY2ggY2FycmllcgoKYGBge3J9CnRvdGFsX3NpbmdsZV9lbmdpbmVfY2Fycmllcl9kaXN0YW5jZSA8LSBzaW5nbGVfZW5naW5lX2ZsaWdodHMgJT4lIAogIGdyb3VwX2J5KGNhcnJpZXIpICU+JSAKICBzdW1tYXJpc2UodG90YWxfZGlzdGFuY2UgPSBzdW0oZGlzdGFuY2UpKQpgYGAKCgo1LiBBbmQgbm93IHdlIG5lZWQgdG8gYWRkIG9uIHRoZSBjYXJyaWVyIG5hbWVzIGFuZCBzb3J0IHRoZSByZXN1bHQgc28gdGhlIGxvbmdlc3QgZGlzdGFuY2UgaXMgZmlyc3QuIFRoaXMgdGltZSB3ZSdsbCBkbyBpdCB1c2luZyBwaXBlLgoKYGBge3J9CnRvdGFsX3NpbmdsZV9lbmdpbmVfY2Fycmllcl9kaXN0YW5jZSAlPiUgCiAgaW5uZXJfam9pbihhaXJsaW5lcywgYnkgPSAnY2FycmllcicpICU+JSAKICBhcnJhbmdlKGRlc2ModG90YWxfZGlzdGFuY2UpKQpgYGAKCkZyb20gdGhpcyB3ZSBjYW4gc2VlIHRoYXQgSmV0Qmx1ZSBBaXJ3YXlzIGZsZXcgdGhlIGxvbmdlc3QgZGlzdGFuY2UgdXNpbmcgc2luZ2xlLWVuZ2luZSBwbGFuZXMu</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("07-combine.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
